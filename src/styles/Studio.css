/* src/styles/Studio.css (improved) */

/* Using theme variables from index.css for consistency */
:root{
  --studio-bg: #0c0c1f;
  --panel-bg: rgba(10, 6, 18, 0.65);
  --panel-border: 1px solid rgba(127, 90, 240, 0.2);
  --control-bg: rgba(30, 0, 60, 0.4);
  --control-hover-bg: rgba(127, 90, 240, 0.25);
  --accent-glow: 0 0 12px rgba(127, 90, 240, 0.4);

  /* fallbacks if index.css doesn't define them */
  --brand-purple: var(--brand-purple, #7f5af0);
  --brand-pink:   var(--brand-pink,   #ff66c4);

  /* tokens */
  --radius: 10px;
  --gap: 8px;

  /* overlay stacking */
  --z-modal: 10000;
  --z-toast: 9000;
  --z-context: 8500;
  --z-panel: 250;
}

/* base */
.studio-container {
  height: 100vh;
  display: flex;
  background: linear-gradient(135deg, #0c0c1f, #140020);
  overflow: hidden;
  font-family: 'Space Grotesk', sans-serif;
  color: var(--text-light);
  position: relative;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* panels */
.studio-panel {
  background: var(--panel-bg);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
  transition: width 0.18s ease, transform 0.12s ease;
  border-radius: var(--radius);
  pointer-events: auto;
}

/* palette */
.palette-panel {
  border-right: var(--panel-border);
  flex-shrink: 0;
  position: relative;
  display: flex;
  flex-direction: column;
  padding: 0.75rem;
  gap: 0.5rem;
  overflow-y: auto;
  min-width: 44px; /* supports collapsed state */
}

/* Resizer - bigger hit area while keeping visible handle slim */
.palette-resizer {
  position: absolute;
  top: 0;
  right: -6px;     /* extend hit area */
  width: 12px;     /* larger interactive region */
  height: 100%;
  cursor: col-resize;
  z-index: 10;
  background: transparent;
}
.palette-resizer::after{
  content: "";
  position: absolute;
  right: 2px;
  top: 50%;
  transform: translateY(-50%);
  width: 2px;
  height: 36px;
  background: rgba(255,255,255,0.04);
  border-radius: 2px;
}

/* properties panel */
.properties-panel {
  position: absolute;
  border: var(--panel-border);
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
  border-radius: 12px;
  z-index: calc(var(--z-panel) + 20);
  overflow: auto;
  padding: 8px;
  min-width: 260px;
  max-width: 520px;
  pointer-events: auto;
}

.properties-drag-handle {
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  cursor: move;
  -webkit-user-select: none;
  user-select: none;
  margin-bottom: 6px;
}
.properties-drag-handle div {
  width: 6px; height: 6px; border-radius: 999px;
  background: rgba(127, 90, 240, 0.45);
}
.properties-resizer {
  position: absolute; left: -8px; top: 0; bottom: 0;
  width: 14px; cursor: col-resize; z-index: 10;
  background: transparent;
}

/* workspace layout */
.workspace-area {
  flex: 1; position: relative; display: flex; flex-direction: column;
}

/* toolbar */
.studio-toolbar {
  position: absolute; right: 14px; top: 14px; z-index: calc(var(--z-panel) + 40);
  display: flex; gap: 8px; align-items: center;
}

/* buttons */
.studio-btn {
  display: flex; align-items: center; justify-content: center; gap: 8px;
  padding: 8px 12px; background: var(--control-bg);
  border: var(--panel-border); border-radius: var(--radius);
  color: var(--text-muted); font-weight: 600; cursor: pointer;
  font-size: 14px; transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  min-height: 36px;
  line-height: 1;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}
.studio-btn:hover {
  background: var(--control-hover-bg); color: #fff;
  box-shadow: var(--accent-glow); transform: translateY(-2px);
}
.studio-btn.icon-btn { padding: 8px; font-size: 16px; }

/* focus for accessibility */
.studio-btn:focus-visible, .context-menu-btn:focus-visible, .studio-toolbar button:focus-visible {
  box-shadow: 0 0 0 4px rgba(127,90,240,0.14);
  border-color: rgba(127,90,240,0.35);
}

/* segmented control (uses brand variables) */
.segmented-control {
  display: flex; border-radius: 10px; overflow: hidden;
  border: var(--panel-border); background: rgba(10, 0, 20, 0.45);
}
.segmented-control button {
  padding: 8px 12px; cursor: pointer; border: none;
  background: transparent; color: var(--text-muted);
  font-weight: 700; transition: all 0.14s ease;
}
.segmented-control button.active {
  background: linear-gradient(90deg, var(--brand-purple), var(--brand-pink));
  color: #fff; text-shadow: 0 0 8px rgba(0,0,0,0.5);
}

/* snap control styles */
.snap-control {
  display: flex; align-items: center; gap: var(--gap);
  padding: 0 8px;
}
.snap-control input[type="number"] {
  width: 60px; background: rgba(0,0,0,0.3);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px; padding: 4px 6px; color: var(--text-light);
}

/* status bar */
.status-bar {
  position: absolute; left: 50%; bottom: 8px; transform: translateX(-50%);
  pointer-events: auto; padding: 6px 16px; border-radius: 999px;
  background: rgba(0, 0, 0, 0.4); color: var(--text-muted); font-size: 12px;
  border: var(--panel-border);
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  white-space: nowrap; z-index: calc(var(--z-panel) + 10);
}

/* context menu */
.context-menu {
  position: fixed; background: var(--panel-bg); border: var(--panel-border);
  border-radius: 8px; box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
  z-index: var(--z-context); padding: 6px; min-width: 180px;
  -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px);
}
.context-menu-btn {
  display: flex; align-items: center; gap: 8px; width: 100%;
  padding: 8px; border-radius: 6px; background: transparent;
  color: var(--text-light); border: none; text-align: left;
  cursor: pointer; font-size: 13px;
}
.context-menu-btn:hover { background: var(--control-hover-bg); }
.context-menu-btn.delete { color: var(--brand-pink); }

/* toasts / modals / loader: defined z-index scale */
.toast-container, .modal-container, .loader-container {
  position: fixed; z-index: var(--z-toast); display: flex;
  align-items: center; justify-content: center;
}
.toast-item, .modal-content, .loader-content {
  background: var(--panel-bg); color: var(--text-light);
  border-radius: 12px; box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
  border: var(--panel-border);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
}
.toast-container {
  left: 18px; bottom: 18px; align-items: flex-start;
  flex-direction: column; gap: 8px;
}
.toast-item {
  padding: 12px 16px; min-width: 240px;
  animation: toastIn .18s cubic-bezier(.2,.9,.3,1);
}
@keyframes toastIn {
  from { transform: translateY(8px); opacity: 0; }
  to   { transform: translateY(0);   opacity: 1; }
}

.modal-container { inset: 0; background: rgba(0,0,0,0.5); z-index: var(--z-modal); }
.modal-content { width: 380px; padding: 24px; }
.loader-container { inset: 0; pointer-events: none; z-index: calc(var(--z-toast) + 10); }
.loader-content { pointer-events: auto; padding: 18px; min-width: 220px; text-align: center; }

/* subtle scrollbars for panels */
.palette-panel::-webkit-scrollbar, .properties-panel::-webkit-scrollbar {
  width: 10px; height: 10px;
}
.palette-panel::-webkit-scrollbar-thumb, .properties-panel::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.04); border-radius: 8px;
}

/* reduced-motion support */
@media (prefers-reduced-motion: reduce) {
  .studio-btn, .segmented-control button, .toast-item { transition: none !important; animation: none !important; }
}

/* mobile / small screens: keep toolbar usable */
@media (max-width: 800px) {
  .studio-toolbar { left: 50%; right: auto; transform: translateX(-50%); top: 8px; display: flex; gap: 6px; }
  .properties-panel { right: 8px; left: 8px; width: auto; max-width: none; bottom: 12px; top: 64px; }
}

/* small helpers */
.hidden { display: none !important; }
.centered { display:flex; align-items:center; justify-content:center; }

/* ensure focusable elements show clear outline for keyboard users */
button, [role="button"], input[type="button"], input[type="submit"] {
  -webkit-tap-highlight-color: rgba(0,0,0,0.0);
}


/* ----- Tab visibility safety + subtle fade ----- */
/* .props-section is controlled by inline styles in Studio.jsx (display:block/none)
   but these rules ensure accessibility + non-interactivity if aria-hidden is used instead. */

.props-section {
  will-change: opacity, transform;
  transition: opacity 160ms ease, transform 160ms ease;
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto; /* interactive when visible */
}

/* If aria-hidden is true (or JS chooses to hide with attribute), make it inert */
.props-section[aria-hidden="true"] {
  opacity: 0;
  transform: translateY(6px);
  pointer-events: none;
  /* keep it out of tab order for screen readers that respect aria-hidden */
}

/* Extra: make sure inline display:none still prevents layout flash,
   but this attribute-driven approach covers other cases and improves accessibility. */
/* Studio-specific adjustments */

/* Smooth reveal used for sections so they don't all pop at once */
.reveal { opacity: 0; transform: translateY(12px); transition: opacity 0.48s cubic-bezier(.2,.98,.28,1), transform 0.48s cubic-bezier(.2,.98,.28,1); }
.reveal.is-visible { opacity: 1; transform: translateY(0); }

/* Properties panel: fixed-ish container and scrollable content */
.properties-panel {
  position: fixed;
  right: 20px;
  top: 88px; /* fallback; JS sets inline top from toolbar height */
  height: calc(100vh - 120px);
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  z-index: 120;
  background: var(--glass-dark);
  border: 1px solid rgba(255,255,255,0.04);
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  overflow: hidden;
  border-radius: 10px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.5);
}

/* Internal scroll area if needed */
.properties-panel > [style*="overflowY"] {
  overflow-y: auto;
  padding-right: 8px;
}

/* Make card/tool hints on top */
.fullscreen-hint { z-index: 8; }

/* Palette panel resizing handle */
.palette-resizer {
  position: absolute;
  right: 0;
  top: 0;
  width: 8px;
  height: 100%;
  cursor: ew-resize;
  z-index: 30;
}

/* Studio toolbar minor tweaks */
.studio-toolbar { position: sticky; top: 12px; z-index: 30; background: transparent; padding: 6px; display: flex; gap: 8px; align-items: center; }

/* Loader tweaks if you use it */
.loader-container { position: fixed; left: 50%; top: 50%; transform: translate(-50%,-50%); z-index: 9999; pointer-events: none; }
.loader-content { background: rgba(6,8,14,0.86); padding: 12px 16px; border-radius: 10px; color: var(--text-light); box-shadow: 0 8px 40px rgba(0,0,0,0.6); pointer-events: all; }

/* Ensure object-properties area content scrolls nicely */
.object-properties {
  max-height: calc(100vh - 180px);
  overflow-y: auto;
  padding: 12px;
}

/* Minor: ensure transform controls or overlay sits on top of model-viewer */
canvas, model-viewer { position: relative; z-index: 1; }
.transform-controls-canvas { z-index: 10; pointer-events: auto; }

/* Responsive adjustments */
@media (max-width: 980px) {
  .properties-panel { right: 8px; left: 8px; width: auto; height: 46vh; bottom: 8px; top: auto; border-radius: 8px; }
}
